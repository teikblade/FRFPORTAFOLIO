<!DOCTYPE html>
<html lang="en">
    <head>
        <title></title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css" integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous">
    </head>
    <style>
        .btn-height{
            height: 200px;
        }
        .header-height{
            height: 100px;
        }
        header{
            margin-bottom: 4%;
        }
        .table-margin{
            margin-top: 2%;
        }
    </style>
    <body>
        <header class="bg-dark header-height"></header>
        <div class="container-fluid">
            <div>
                <h4>DEMO API JSON mindicador.cl</h4>
            </div>
            <div class="row">
                <div class="col-4">
                    <button id="dolar" class="btn btn-block btn-outline-success btn-height font-weight-bold">DOLAR</button>
                </div>
                <div class="col-4">
                    <button id="euro" class="btn btn-block btn-outline-warning btn-height font-weight-bold">ERURO</button>
                </div>
                <div class="col-4">
                    <button id="bitcoin" class="btn btn-block btn-outline-danger btn-height font-weight-bold">BITCOIN</button>
                </div>
            </div>
            <div class="row">
                <div class="col-12 bg-dark table-margin">
                    <h4 id="apijsonmoneda" class="text-center text-white"></h4>
                </div>
            </div>
            <div class="row">
                    <table id="apijson" class="table table-hover table-dark text-center col-12"></table>
            </div>
        </div>
        <script>
            document.getElementById('dolar').addEventListener('click', function(){ 
                ApiJson('dolar');
            })
            document.getElementById('euro').addEventListener('click', function(){ 
                ApiJson('euro');
            })
            document.getElementById('bitcoin').addEventListener('click', function(){ 
                ApiJson('bitcoin');
            })
            function ApiJson(moneda){
                console.log('activo');
                let valor = moneda;
                let url = `https://mindicador.cl/api/${moneda}`;
                const xhttp = new XMLHttpRequest();
                xhttp.onreadystatechange = function(){ 
                    if(this.readyState == 4 && this.status == 200){ 
                        let datos = JSON.parse(this.responseText);
                        let res = document.getElementById('apijson');
                        res.innerHTML = '';
                        var i = 1;
                        let moneda = document.getElementById('apijsonmoneda');
                        moneda.innerHTML = valor.toUpperCase();
                        res.innerHTML +=`
                        <thead>
                            <tr>
                                <th>FECHA</th>
                                <th>VALOR</th>
                            </tr>
                        </thead>
                        <tbody>`
                        for(let item of datos.serie){ 
                            res.innerHTML += `
                            <tr>
                                <td>${item.fecha.slice(0,-14)}</td>
                                <td>${item.valor}</td>
                            </tr>`;
                            i++;
                            if(i>5){ 
                                break;
                            }
                        }
                        res.innerHTML += `</tbody>`
                    }
                }
                xhttp.open('GET',url,true);
                xhttp.send();
                
            }
        </script>
    </body>
</html>